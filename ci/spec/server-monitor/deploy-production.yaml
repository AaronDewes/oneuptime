deploy_production_server-monitor:
  stage: Deploy
  script:
    - sudo apt-get update
    - sudo apt-get install -y curl gcc
    - sudo apt-get install -y build-essential
    - curl -sL https://deb.nodesource.com/setup_12.x | sudo -E bash -
    - sudo apt-get install -y nodejs
    - chmod +x ./ci/scripts/version-setup.sh
    - ./ci/scripts/version-setup.sh
    - cd server-monitor
    - echo "//registry.npmjs.org/:_authToken=$NPM_AUTH_TOKEN" > ~/.npmrc
    # - git checkout server-monitor-staging
    - npm publish
    - cd ..
  only:
    refs:
      - release
      - hotfix-release
  environment:
    name: production