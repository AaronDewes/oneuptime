## DEPLOYMENT STAGE - Log JS
deploy_staging_log-js:
    stage: Deploy
    allow_failure: true
    script:
        - sudo apt-get update
        - sudo apt-get install -y curl gcc
        - sudo apt-get install -y build-essential
        - curl -sL https://deb.nodesource.com/setup_12.x | sudo -E bash -
        - sudo apt-get install -y nodejs
        - sudo npm install -g json
        - git add -A
        - git commit -m "staging deployment"
        - chmod +x ./ci/scripts/version-setup.sh
        - ./ci/scripts/version-setup.sh
        - cd log-js
        - json -I -f package.json -e 'this.name="fyipe-log-js-staging"'
        - echo "//registry.npmjs.org/:_authToken=$NPM_AUTH_TOKEN" > ~/.npmrc
        - npm publish
        - git add -A
        - git commit -m "staging deployment"
        - git push https://$GITHUB_USERNAME:$GITHUB_PASSWORD@github.com/Fyipe/log-js.git staging --force
        - cd ..
    except:
        refs:
            - master
            - hotfix-master
    environment:
        name: staging
# deploy_production_server-monitor:
#     stage: Deploy
#     script:
#         - sudo apt-get update
#         - sudo apt-get install -y curl gcc
#         - sudo apt-get install -y build-essential
#         - curl -sL https://deb.nodesource.com/setup_12.x | sudo -E bash -
#         - sudo apt-get install -y nodejs
#         - sudo npm install -g json
#         - chmod +x ./ci/scripts/version-setup.sh
#         - ./ci/scripts/version-setup.sh
#         - cd log-js
#         - json -I -f package.json -e 'this.name="fyipe-log-js"'
#         - echo "//registry.npmjs.org/:_authToken=$NPM_AUTH_TOKEN" > ~/.npmrc
#         - npm publish
#         - git init
#         - git add -A
#         - git commit -m "production deployment"
#         - git push https://$GITHUB_USERNAME:$GITHUB_PASSWORD@github.com/Fyipe/log-js.git master --force
#         - cd ..
#     except:
#         refs:
#             - release
#             - hotfix-release
#     environment:
#         name: production
